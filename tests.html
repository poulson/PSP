

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Test drivers &mdash; Parallel Sweeping Preconditioner 0.1 documentation</title>
    
    <link rel="stylesheet" href="_static/haiku.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/print.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="_static/theme_extras.js"></script>
    <link rel="top" title="Parallel Sweeping Preconditioner 0.1 documentation" href="index.html" />
    <link rel="next" title="Example driver(s)" href="examples.html" />
    <link rel="prev" title="The DistHelmholtz class" href="dist_helmholtz.html" /> 
  </head>
  <body>
      <div class="header"><h1 class="heading"><a href="index.html">
          <span>Parallel Sweeping Preconditioner 0.1 documentation</span></a></h1>
        <h2 class="heading"><span>Test drivers</span></h2>
      </div>
      <div class="topnav">
      
        <p>
        «&#160;&#160;<a href="dist_helmholtz.html">The <tt class="docutils literal"><span class="pre">DistHelmholtz</span></tt> class</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="examples.html">Example driver(s)</a>&#160;&#160;»
        </p>

      </div>
      <div class="content">
        
        
  <div class="section" id="test-drivers">
<h1>Test drivers<a class="headerlink" href="#test-drivers" title="Permalink to this headline">¶</a></h1>
<div class="section" id="analytical-velocity-models">
<h2>Analytical velocity models<a class="headerlink" href="#analytical-velocity-models" title="Permalink to this headline">¶</a></h2>
<div class="section" id="uniform">
<h3>0. Uniform<a class="headerlink" href="#uniform" title="Permalink to this headline">¶</a></h3>
<p>A constant unit velocity field. This should be the ideal setting for the
preconditioner.</p>
<img alt="_images/velocity-uniform.png" src="_images/velocity-uniform.png" />
</div>
<div class="section" id="converging-lens">
<h3>1. Converging lens<a class="headerlink" href="#converging-lens" title="Permalink to this headline">¶</a></h3>
<p>One of the models tested in Engquist and Ying&#8217;s <em>Sweeping preconditioner for
the Helmholtz equation: moving Perfectly Matched Layers</em>.</p>
<img alt="_images/velocity-gaussian.png" src="_images/velocity-gaussian.png" />
</div>
<div class="section" id="wave-guide">
<h3>2. Wave guide<a class="headerlink" href="#wave-guide" title="Permalink to this headline">¶</a></h3>
<p>Another model tested in Engquist and Ying&#8217;s <em>Sweeping preconditioner for
the Helmholtz equation: moving Perfectly Matched Layers</em>.</p>
<img alt="_images/velocity-guide.png" src="_images/velocity-guide.png" />
</div>
<div class="section" id="two-decreasing-layers">
<h3>3. Two decreasing layers<a class="headerlink" href="#two-decreasing-layers" title="Permalink to this headline">¶</a></h3>
<p>Two layers stacked on top of each other, where the bottom layer has a velocity
which is four times higher than in the top layer.</p>
<img alt="_images/velocity-twoDecLayers.png" src="_images/velocity-twoDecLayers.png" />
</div>
<div class="section" id="two-increasing-layers">
<h3>4. Two increasing layers<a class="headerlink" href="#two-increasing-layers" title="Permalink to this headline">¶</a></h3>
<p>Same as above, but the sweep proceeds from the low to high velocity (instead of
high to low).</p>
<img alt="_images/velocity-twoIncLayers.png" src="_images/velocity-twoIncLayers.png" />
</div>
<div class="section" id="two-sideways-layers">
<h3>5. Two sideways layers<a class="headerlink" href="#two-sideways-layers" title="Permalink to this headline">¶</a></h3>
<p>Same as the above two models, but there is no gradient in the velocity model
in the sweep direction.</p>
<img alt="_images/velocity-twoSidewaysLayers.png" src="_images/velocity-twoSidewaysLayers.png" />
</div>
<div class="section" id="five-decreasing-layers">
<h3>6. Five decreasing layers<a class="headerlink" href="#five-decreasing-layers" title="Permalink to this headline">¶</a></h3>
<p>Test the performance of sweeping from low to high velocities.</p>
<img alt="_images/velocity-fiveDecLayers.png" src="_images/velocity-fiveDecLayers.png" />
</div>
<div class="section" id="five-increasing-layers">
<h3>7. Five increasing layers<a class="headerlink" href="#five-increasing-layers" title="Permalink to this headline">¶</a></h3>
<p>Tests the performance of sweeping from high to low velocities. Ideally,
the sweeping preconditioner should perform worse on this model than the
previous one since the approximated lower half-spaces should have more
significant reflections.</p>
<img alt="_images/velocity-fiveIncLayers.png" src="_images/velocity-fiveIncLayers.png" />
</div>
<div class="section" id="five-sideways-layers">
<h3>8. Five sideways layers<a class="headerlink" href="#five-sideways-layers" title="Permalink to this headline">¶</a></h3>
<p>Tests a five layer model where each panel is equivalent but heterogeneous.</p>
<img alt="_images/velocity-fiveSidewaysLayers.png" src="_images/velocity-fiveSidewaysLayers.png" />
</div>
<div class="section" id="wedge">
<h3>9. Wedge<a class="headerlink" href="#wedge" title="Permalink to this headline">¶</a></h3>
<p>A 3D version of a standard benchmark problem (<strong>citation needed</strong>).</p>
<img alt="_images/velocity-wedge.png" src="_images/velocity-wedge.png" />
</div>
<div class="section" id="random">
<h3>10. Random<a class="headerlink" href="#random" title="Permalink to this headline">¶</a></h3>
<p>Each velocity entry is drawn from a uniform distribution over <span class="math">\([2,3]\)</span>.</p>
<img alt="_images/velocity-random.png" src="_images/velocity-random.png" />
</div>
<div class="section" id="separator">
<h3>11. Separator<a class="headerlink" href="#separator" title="Permalink to this headline">¶</a></h3>
<p>A separator with a velocity ten orders of magnitude higher than the rest
of the medium is inserted to test the robustness of the preconditioner.
Convergence seems to be unaffected by the separator.</p>
<img alt="_images/velocity-separator.png" src="_images/velocity-separator.png" />
</div>
<div class="section" id="cavity">
<h3>12. Cavity<a class="headerlink" href="#cavity" title="Permalink to this headline">¶</a></h3>
<p>A high-velocity outer layer surrounding a low-velocity interior region.
Interior rays become trapped within the low-velocity region and cause resonance
(resulting in poor performance of the preconditioner).</p>
<img alt="_images/velocity-cavity.png" src="_images/velocity-cavity.png" />
</div>
<div class="section" id="reverse-cavity">
<h3>13. Reverse cavity<a class="headerlink" href="#reverse-cavity" title="Permalink to this headline">¶</a></h3>
<p>Meant to show that high velocity contrasts are not the problem: since rays
do not become trapped, the preconditioner performs very well on this velocity
model.</p>
<img alt="_images/velocity-reverseCavity.png" src="_images/velocity-reverseCavity.png" />
</div>
<div class="section" id="bottom-half-of-cavity">
<h3>14. Bottom half of cavity<a class="headerlink" href="#bottom-half-of-cavity" title="Permalink to this headline">¶</a></h3>
<p>If the cavity is on the bottom half of the domain, sweeping
upwards uses approximations which replace the bottom half of the cavity with
PML, which ignores strong reflections from rays attempting to jump from the
low to high velocity region.</p>
<img alt="_images/velocity-bottomHalfCavity.png" src="_images/velocity-bottomHalfCavity.png" />
</div>
<div class="section" id="top-half-of-cavity">
<h3>15. Top half of cavity<a class="headerlink" href="#top-half-of-cavity" title="Permalink to this headline">¶</a></h3>
<p>Since PSP sweeps upward from the bottom of the domain to the top, this model
should not pose a significant problem since the approximated lower half-space
problems do not replace strong with PML.</p>
<img alt="_images/velocity-topHalfCavity.png" src="_images/velocity-topHalfCavity.png" />
</div>
</div>
<div class="section" id="unitcube">
<h2>UnitCube<a class="headerlink" href="#unitcube" title="Permalink to this headline">¶</a></h2>
<p>This section describes the driver
<a class="reference external" href="https://github.com/poulson/PSP/blob/master/tests/UnitCube.cpp">tests/UnitCube.cpp</a>, which is designed for quickly testing the performance of the sweeping
preconditioner on a variety of different velocity models.</p>
<div class="section" id="parameters">
<h3>Parameters<a class="headerlink" href="#parameters" title="Permalink to this headline">¶</a></h3>
<p>Example usage</p>
<div class="highlight-python"><pre>UnitCube --model 2 --n 100 --omega 60. --pmlSize 5 --sigma 1.5 --fullViz 1</pre>
</div>
<ul class="simple">
<li><cite>model</cite>: which velocity field to use, see <a class="reference internal" href="#analytical-velocity-models">Analytical velocity models</a> (default is the waveguide model)</li>
<li><cite>n</cite>: size of grid in each dimension (default is 40)</li>
<li><cite>omega</cite>: frequency in rad/sec of problem, <span class="math">\(2 \pi (n/10)\)</span> is a reasonable value (default is 30)</li>
<li><cite>pmlOnTop</cite>: PML if nonzero, Dirichlet otherwise (default is true)</li>
<li><cite>pmlSize</cite>: number of grid points of per PML boundary condition (default is 5)</li>
<li><cite>sigma</cite>: magnitude of complex coordinate-stretching for PML (default is 1.5)</li>
<li><cite>damping</cite>: imaginary frequency shift for preconditioner (default is 7)</li>
<li><cite>planesPerPanel</cite>: number of planes per subdomain (default is 4)</li>
<li><cite>panelScheme</cite>: use traditional scheme if 0, selective inversion if 1 (default is 1)</li>
<li><cite>fullViz</cite>: full volume visualization if nonzero (default is false)</li>
<li><cite>nbFact</cite>: algorithmic blocksize for factorization (default is 96)</li>
<li><cite>nbSolve</cite>: algorithmic blocksize for solves (default is 64)</li>
</ul>
<p>For each run of the <tt class="docutils literal"><span class="pre">UnitCube</span></tt> driver, four different sets of sources are used:</p>
<ol class="arabic simple">
<li>A single localized Gaussian centered at <span class="math">\((0.5,0.5,0.1)\)</span>.</li>
<li>Three localized Gaussians, centered at <span class="math">\((0.5,0.5,0.1)\)</span>, <span class="math">\((0.25,0.25,0.1)\)</span>, and <span class="math">\((0.75,0.75,0.5)\)</span>.</li>
<li>A Gaussian beam centered at <span class="math">\((0.75,0.75,0.5)\)</span> and pointed in the direction <span class="math">\((0.57735,0.57735,-0.57735)\)</span>.</li>
<li>A plane wave pointed in the same direction as the Gaussian beam, but with support in the complement of PML.</li>
</ol>
</div>
<div class="section" id="uniform-example">
<h3>Uniform example<a class="headerlink" href="#uniform-example" title="Permalink to this headline">¶</a></h3>
<p>The following results are gathered from running at 314.16 rad/sec over the
uniform velocity model with a <span class="math">\(500 \times 500 \times 500\)</span> grid, via the
command:</p>
<div class="highlight-python"><pre>UnitCube --model 0 --n 500 --omega 314.16 --fullViz 1</pre>
</div>
<p>which converged to five digits of relative accuracy in 22 iterations of
GMRES(20) on 256 nodes of TACC&#8217;s Lonestar.</p>
<img alt="_images/solution-uniform-singleShot-YZ-50.png" src="_images/solution-uniform-singleShot-YZ-50.png" />
<p>The middle YZ plane of the single-shot solution.</p>
<img alt="_images/solution-uniform-threeShots-YZ-50-0.6.png" src="_images/solution-uniform-threeShots-YZ-50-0.6.png" />
<p>A slightly off-center YZ plane (x=0.6) of the three-shot solution.</p>
<img alt="_images/solution-uniform-planeWave-YZ-50.png" src="_images/solution-uniform-planeWave-YZ-50.png" />
<p>The middle YZ plane of the plane wave solution.</p>
</div>
<div class="section" id="converging-lens-example">
<h3>Converging lens example<a class="headerlink" href="#converging-lens-example" title="Permalink to this headline">¶</a></h3>
<p>This example used the converging lens velocity model at 235.62 rad/sec over
another <span class="math">\(500 \times 500 \times 500\)</span> grid, via the command:</p>
<div class="highlight-python"><pre>UnitCube --model 1 --n 500 --omega 235.62 --sigma 2.0 --fullViz 1</pre>
</div>
<p>and converged to five digits of relative accuracy in 44 iterations of GMRES(20)
on 256 nodes of TACC&#8217;s Lonestar.</p>
<img alt="_images/solution-gaussian-singleShot-YZ-37.5.png" src="_images/solution-gaussian-singleShot-YZ-37.5.png" />
<p>The middle YZ plane of the single-shot solution.</p>
<img alt="_images/solution-gaussian-threeShots-YZ-37.5.png" src="_images/solution-gaussian-threeShots-YZ-37.5.png" />
<p>The middle YZ plane of the three-shot solution.</p>
<img alt="_images/solution-gaussian-planeWave-YZ-37.5.png" src="_images/solution-gaussian-planeWave-YZ-37.5.png" />
<p>The middle YZ plane of the plane wave solution.</p>
</div>
<div class="section" id="wave-guide-example">
<h3>Wave guide example<a class="headerlink" href="#wave-guide-example" title="Permalink to this headline">¶</a></h3>
<p>This third example uses the wave guide velocity model over a
<span class="math">\(500 \times 500 \times 500\)</span> grid, again at 235.62 rad/sec. Using five
grid points of PML, with a coordinate-stretching magnitude of 2.0, via:</p>
<div class="highlight-python"><pre>UnitCube --model 2 --n 500 --omega 235.62 --sigma 2.0 --fullViz 1</pre>
</div>
<p>and all four residuals converged to five digits of relative accuracy in
52 iterations of GMRES(20) on 256 nodes of TACC&#8217;s Lonestar. With six grid points
of PML, via:</p>
<div class="highlight-python"><pre>UnitCube --model 2 --n 500 --omega 235.62 --pmlSize 6 --sigma 2.0 --fullViz 1</pre>
</div>
<p>the same model converged in 27 iterations.</p>
<img alt="_images/solution-guide-singleShot-YZ-37.5.png" src="_images/solution-guide-singleShot-YZ-37.5.png" />
<p>The middle YZ plane of the single-shot solution.</p>
<img alt="_images/solution-guide-singleShot-YZ-37.5-0.55.png" src="_images/solution-guide-singleShot-YZ-37.5-0.55.png" />
<p>An off-center YZ plane (x=0.55) of the single-shot solution.</p>
<img alt="_images/solution-guide-threeShots-YZ-37.5.png" src="_images/solution-guide-threeShots-YZ-37.5.png" />
<p>The middle YZ plane of the three-shot solution.</p>
<img alt="_images/solution-guide-threeShots-YZ-37.5-0.55.png" src="_images/solution-guide-threeShots-YZ-37.5-0.55.png" />
<p>An off-center YZ plane (x=0.55) of the three-shot solution.</p>
<img alt="_images/solution-guide-planeWave-YZ-37.5.png" src="_images/solution-guide-planeWave-YZ-37.5.png" />
<p>The middle YZ plane of the plane wave solution.</p>
</div>
<div class="section" id="two-sideways-layers-example">
<h3>Two sideways layers example<a class="headerlink" href="#two-sideways-layers-example" title="Permalink to this headline">¶</a></h3>
<p>This example tests a velocity model which is split between a two materials
with wave speeds which vary by a factor of four. The grid size was
<span class="math">\(500 \times 500 \times 500\)</span>, and the frequency was set to 314.16
radians/second. Using a PML magnitude of 4.0, via the command:</p>
<div class="highlight-python"><pre>UnitCube --model 5 --n 500 --omega 314.16 --sigma 4.0 --fullViz 1</pre>
</div>
<p>all four residuals converged to five digits of relative accuracy in
48 iterations of GMRES(20) on 256 nodes of TACC&#8217;s Lonestar.</p>
<img alt="_images/solution-twoSidewaysLayers-singleShot-YZ-50.png" src="_images/solution-twoSidewaysLayers-singleShot-YZ-50.png" />
<p>The middle YZ plane of the single-shot solution.</p>
<img alt="_images/solution-twoSidewaysLayers-singleShot-YZ-50-0.7.png" src="_images/solution-twoSidewaysLayers-singleShot-YZ-50-0.7.png" />
<p>An off-center YZ plane (x=0.7) of the single-shot solution.</p>
<img alt="_images/solution-twoSidewaysLayers-threeShots-YZ-50.png" src="_images/solution-twoSidewaysLayers-threeShots-YZ-50.png" />
<p>The middle YZ plane of the three-shot solution.</p>
<img alt="_images/solution-twoSidewaysLayers-threeShots-YZ-50-0.7.png" src="_images/solution-twoSidewaysLayers-threeShots-YZ-50-0.7.png" />
<p>An off-center YZ plane (x=0.7) of the three-shot solution.</p>
</div>
<div class="section" id="wedge-example">
<h3>Wedge example<a class="headerlink" href="#wedge-example" title="Permalink to this headline">¶</a></h3>
<p>This example tests a velocity model which is split between a three different
materials, with the lowest velocity material wedged into the middle. The grid
size was <span class="math">\(500 \times 500 \times 500\)</span>, and the frequency was set to 471.25
radians/second. Using a PML magnitude of 4.0, via the command:</p>
<div class="highlight-python"><pre>UnitCube --model 9 --n 500 --omega 471.25 --sigma 4.0 --fullViz 1</pre>
</div>
<p>all four residuals converged to five digits of relative accuracy in 49
iterations of GMRES(20) on 256 nodes of TACC&#8217;s Lonestar.</p>
<img alt="_images/solution-wedge-singleShot-YZ-75.png" src="_images/solution-wedge-singleShot-YZ-75.png" />
<p>The center YZ plane of the single-shot solution.</p>
<img alt="_images/solution-wedge-singleShot-YZ-75-0.7.png" src="_images/solution-wedge-singleShot-YZ-75-0.7.png" />
<p>An off-center YZ plane (x=0.7) of the single-shot solution.</p>
<img alt="_images/solution-wedge-threeShots-YZ-75-0.7.png" src="_images/solution-wedge-threeShots-YZ-75-0.7.png" />
<p>An off-center YZ plane (x=0.7) of the three-shot solution.</p>
</div>
<div class="section" id="id1">
<h3>Separator<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>This example shows that extremely large variations in the velocity field can
be harmless: even though there is a &#8220;separator&#8221; with a velocity which is ten
orders of magnitude larger than the background velocity, the sweeping
preconditioner converged in only 28 iterations for the 50 wavelength
calculation:</p>
<div class="highlight-python"><pre>UnitCube --model 11 --n 500 --omega 314.16 --sigma 3.0 --fullViz 1</pre>
</div>
<img alt="_images/solution-separator-singleShot-YZ-50-0.7.png" src="_images/solution-separator-singleShot-YZ-50-0.7.png" />
<p>An off-center YZ plane (x=0.7) of the single-shot solution.</p>
<img alt="_images/solution-separator-threeShots-YZ-50-0.7.png" src="_images/solution-separator-threeShots-YZ-50-0.7.png" />
<p>An off-center YZ plane (x=0.7) of the three-shot solution.</p>
</div>
</div>
<div class="section" id="interpolate">
<h2>Interpolate<a class="headerlink" href="#interpolate" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference external" href="https://github.com/poulson/PSP/blob/master/tests/Interpolate.cpp">tests/Interpolate.cpp driver</a>
is meant to exercise the routine
<a class="reference internal" href="dist_uniform_grid.html#DistUniformGrid:F:::InterpolateTo__i.i.i" title="DistUniformGrid&lt;F&gt;::InterpolateTo"><tt class="xref cpp cpp-func docutils literal"><span class="pre">DistUniformGrid&lt;F&gt;::InterpolateTo()</span></tt></a>, which provides a means of
linearly interpolating a velocity model into a different grid size in parallel.</p>
<div class="section" id="id2">
<h3>Parameters<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<p>Example usage</p>
<div class="highlight-python"><pre>Interpolate --model 2 --m1 30 --m2 30 --m3 30 --n1 40 --n2 40 --n3 40</pre>
</div>
<ul class="simple">
<li><cite>model</cite>: see <a class="reference internal" href="#analytical-velocity-models">Analytical velocity models</a> (default is waveguide model)</li>
<li><cite>m1</cite>, <cite>m2</cite>, <cite>m3</cite>: original grid size (default values are 30)</li>
<li><cite>n1</cite>, <cite>n2</cite>, <cite>n3</cite>: interpolated grid size (default values are 40)</li>
</ul>
<p><strong>TODO:</strong> Show some results.</p>
</div>
</div>
</div>


      </div>
      <div class="bottomnav">
      
        <p>
        «&#160;&#160;<a href="dist_helmholtz.html">The <tt class="docutils literal"><span class="pre">DistHelmholtz</span></tt> class</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="examples.html">Example driver(s)</a>&#160;&#160;»
        </p>

      </div>

    <div class="footer">
        &copy; Copyright 2012, Jack Poulson.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>